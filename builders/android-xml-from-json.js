const flatten = require('lodash/flatten')
const repeat = require('lodash/repeat')
const toSnakeCase = require('lodash/snakeCase')

const PALETTE = require('../dist/colors.json')

const paletteColors = flatten(PALETTE.colors.map(colorArray => {
  return colorArray.map(formatShade)
}))

function formatColors(colorArrays, indent = 0) {
  const prefix = repeat(' ', indent)
  return flatten(colorArrays).map(c => prefix + c).join('\n')
}

function formatShade(colorObject) {
  return `<color name="${toSnakeCase(colorObject.name)}">${colorObject.value}</color>`
}

console.log('<?xml version="1.0" encoding="utf-8"?>')
console.log('\n<resources')
console.log('    xmlns:tools="http://schemas.android.com/tools"')
console.log('    tools:ignore="UnusedResources">')
console.log(`\n    <!-- Generated by Color Studio v${PALETTE.version} -->`)
console.log(formatColors(paletteColors, 4))
console.log('\n</resources>')
